<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OTG Factory v80.1 (Master Edition)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;800&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; background-color: #0f172a; color: #f8fafc; }
    .step-section { display: none; }
    .step-section.active { display: block; animation: fadeIn 0.4s ease-out; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    .input-field { width: 100%; background: #1e293b; border: 2px solid #475569; padding: 1rem; border-radius: 0.75rem; color: white; font-size: 1.1rem; transition: border-color 0.2s; font-weight: 600; }
    .input-field:focus { border-color: #3b82f6; outline: none; background: #0f172a; }
    .btn { padding: 1rem 2rem; border-radius: 0.75rem; font-weight: 800; transition: all 0.2s; cursor: pointer; }
    .btn-primary { background: #2563eb; color: white; }
    .btn-primary:hover { background: #1d4ed8; transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgba(37, 99, 235, 0.4); }
    .highlight-box { background: #1e293b; border: 1px solid #334155; border-radius: 1rem; padding: 2rem; }
    .preset-swatch { width: 44px; height: 44px; border-radius: 50%; cursor: pointer; border: 3px solid transparent; transition: all 0.2s; overflow: hidden; display: flex; }
    .preset-swatch:hover { transform: scale(1.1); }
    .preset-swatch.selected { border-color: white; transform: scale(1.1); box-shadow: 0 0 15px rgba(255,255,255,0.3); }
    .swatch-half { width: 50%; height: 100%; }
  </style>
</head>
<body class="min-h-screen p-4 md:p-8 text-slate-100">

  <div class="max-w-6xl mx-auto">
    <header class="flex flex-col md:flex-row justify-between items-center mb-12 gap-6 bg-slate-900/50 p-8 rounded-3xl border border-slate-800 shadow-2xl">
      <div class="flex items-center gap-6">
        <div class="bg-blue-600 p-4 rounded-2xl shadow-lg shadow-blue-500/20">
          <span class="text-4xl">üèóÔ∏è</span>
        </div>
        <div>
          <h1 class="text-3xl font-black text-white uppercase tracking-tighter">OTG <span class="text-blue-500">Factory</span></h1>
          <p class="text-slate-400 font-medium">Lone Worker AppSuite Compiler v80.1</p>
        </div>
      </div>
      <nav class="flex bg-slate-800/50 p-1.5 rounded-2xl border border-slate-700">
        <button onclick="gotoStep(1)" class="nav-btn active px-6 py-2.5 rounded-xl text-sm font-black uppercase tracking-widest transition-all">1. Config</button>
        <button onclick="gotoStep(2)" class="nav-btn px-6 py-2.5 rounded-xl text-sm font-black uppercase tracking-widest transition-all">2. Database</button>
        <button onclick="gotoStep(3)" class="nav-btn px-6 py-2.5 rounded-xl text-sm font-black uppercase tracking-widest transition-all">3. Download</button>
      </nav>
    </header>

    <div id="step1" class="step-section active">
      <div class="grid lg:grid-cols-2 gap-12 items-start">
        
        <div class="space-y-8">
          <div class="highlight-box border-blue-500/30">
            <h3 class="text-xl font-black text-white mb-6 uppercase tracking-widest flex items-center gap-3">
              <span class="bg-blue-500/20 p-2 rounded-lg text-blue-400">üé®</span> Brand Identity
            </h3>
            <div class="space-y-6">
              <div>
                <label class="block text-slate-400 text-xs font-black uppercase tracking-widest mb-2">Organisation Name</label>
                <input type="text" id="orgName" oninput="saveInput(this)" placeholder="e.g. Acme Services" class="input-field">
              </div>
              <div>
                <label class="block text-slate-400 text-xs font-black uppercase tracking-widest mb-2">Square Logo URL (PNG/JPG)</label>
                <input type="text" id="logoUrl" oninput="saveInput(this)" placeholder="https://..." class="input-field">
              </div>
              <div class="grid grid-cols-2 gap-4">
                <div>
                  <label class="block text-slate-400 text-xs font-black uppercase tracking-widest mb-2">Primary Color</label>
                  <div class="flex gap-3 items-center">
                    <input type="color" id="primaryColor" oninput="saveInput(this)" class="h-12 w-12 rounded-lg cursor-pointer bg-transparent">
                    <div id="primaryColorBox" class="flex-1 h-12 rounded-xl border-2 border-slate-700 bg-blue-900"></div>
                  </div>
                </div>
                <div>
                  <label class="block text-slate-400 text-xs font-black uppercase tracking-widest mb-2">Accent Color</label>
                  <div class="flex gap-3 items-center">
                    <input type="color" id="accentColor" oninput="saveInput(this)" class="h-12 w-12 rounded-lg cursor-pointer bg-transparent">
                    <div id="accentColorBox" class="flex-1 h-12 rounded-xl border-2 border-slate-700 bg-blue-500"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div id="paletteArea" class="space-y-8">
            <h3 class="text-white font-black mb-4 uppercase text-[10px] tracking-widest text-center">üì± Live App Preview</h3>
            
            <div id="appMockup" class="mx-auto w-64 h-[450px] rounded-[2.5rem] border-[6px] border-gray-900 bg-[#111827] shadow-2xl overflow-hidden relative transition-all duration-500">
                <div id="mockHeader" class="h-12 border-b border-gray-700 flex items-center px-4 justify-between bg-[#111827] transition-colors duration-500">
                    <div class="flex items-center gap-2">
                        <img id="mockLogo" src="" class="w-5 h-5 rounded-sm bg-white object-contain hidden">
                        <span id="mockOrgName" class="text-[10px] font-bold text-white truncate max-w-[100px]">My Organisation</span>
                    </div>
                    <div class="w-3 h-3 rounded-full bg-gray-700"></div>
                </div>
                <div class="p-4 space-y-4">
                    <div class="flex gap-2">
                        <div class="w-8 h-8 bg-gray-800 rounded-lg border border-gray-700"></div>
                        <div class="w-8 h-8 bg-gray-800 rounded-lg border border-gray-700"></div>
                        <div id="mockTravelCard" class="flex-1 h-8 rounded-lg border border-gray-700 transition-colors duration-500"></div>
                    </div>
                    <div class="grid grid-cols-2 gap-2">
                        <div class="h-20 bg-gray-800 rounded-lg border border-gray-700"></div>
                        <div id="mockAccentCard" class="h-20 border-2 rounded-lg p-2 shadow-lg transition-colors duration-500"></div>
                    </div>
                    <div class="h-2 w-24 bg-gray-700 rounded mx-auto mt-4"></div>
                </div>
                <div id="mockFooter" class="absolute bottom-0 w-full p-4 border-t border-gray-700 bg-[#111827] transition-colors duration-500">
                    <div class="h-1.5 w-full bg-gray-700 rounded mb-3"></div>
                    <div id="mockMainBtn" class="h-10 w-full rounded-xl flex items-center justify-center font-black text-[10px] text-white uppercase tracking-widest shadow-lg transition-colors duration-500">Start Visit</div>
                </div>
            </div>

            <p class="text-[10px] text-gray-400 mt-6 uppercase font-black mb-3 tracking-[0.2em] text-center border-t border-gray-800 pt-4">Enterprise Safe Fallbacks</p>
            <div class="flex gap-4 justify-center mb-10" id="fallbackSwatches">
                <div class="preset-swatch" onclick="applyPreset('#1e40af', '#3b82f6', this)" title="Blue"><div class="swatch-half bg-[#1e40af]"></div><div class="swatch-half bg-[#3b82f6]"></div></div>
                <div class="preset-swatch" onclick="applyPreset('#064e3b', '#10b981', this)" title="Green"><div class="swatch-half bg-[#064e3b]"></div><div class="swatch-half bg-[#10b981]"></div></div>
                <div class="preset-swatch" onclick="applyPreset('#450a0a', '#ef4444', this)" title="Red"><div class="swatch-half bg-[#450a0a]"></div><div class="swatch-half bg-[#ef4444]"></div></div>
                <div class="preset-swatch" onclick="applyPreset('#1e293b', '#64748b', this)" title="Slate"><div class="swatch-half bg-[#1e293b]"></div><div class="swatch-half bg-[#64748b]"></div></div>
            </div>

        </div> </div> <div class="highlight-box border-blue-500/30 mt-8">
        <div class="flex items-center gap-3 mb-6"><span class="text-2xl">üõ°Ô∏è</span><h3 class="text-xl font-black text-white uppercase tracking-widest">Safety & Fleet Options</h3></div>
        <div class="grid md:grid-cols-2 gap-10">
          <div class="space-y-6">
            <div>
              <label class="block text-white font-black text-xs uppercase tracking-widest mb-2">Alarm Grace Period (Mins)</label>
              <input type="number" id="alarmGrace" oninput="saveInput(this)" placeholder="5" class="input-field">
            </div>
            <div>
              <label class="block text-white font-black text-xs uppercase tracking-widest mb-2">Google Maps API Key (Optional)</label>
              <input type="password" id="mapsKey" oninput="saveInput(this)" placeholder="AIZA..." class="input-field">
            </div>
          </div>
          <div class="space-y-6">
            <div class="bg-slate-800/50 p-6 rounded-2xl border border-slate-700">
              <div class="flex items-center justify-between mb-4">
                <label class="text-white font-bold text-sm uppercase tracking-tighter">Vehicle Compliance Engine</label>
                <input type="checkbox" id="vehicleCheck" onchange="saveInput(this)" class="w-6 h-6">
              </div>
              <p class="text-xs text-gray-400">If enabled, workers must perform a daily vehicle safety check and WOF/Rego must be valid to start travel.</p>
            </div>
          </div>
        </div>
      </div>

      <div class="flex justify-end pt-12">
        <button onclick="gotoStep(2)" class="btn btn-primary text-lg px-12 shadow-2xl font-black uppercase tracking-widest transition-transform hover:scale-105">Next: Database Setup ‚Üí</button>
      </div>
    </div> <div id="step2" class="step-section">
      <div class="highlight-box border-green-500/30">
        <h2 class="text-3xl font-black text-white mb-8 uppercase tracking-tighter">Step 2: Database Initialization</h2>
        <div class="grid md:grid-cols-2 gap-12">
          <div>
            <h3 class="text-lg font-black text-green-400 mb-4 uppercase">Option A: The Automated Way</h3>
            <p class="text-gray-400 mb-6 leading-relaxed text-sm">Use our one-click automation to create your private Google Sheet database and link it to your factory.</p>
            <a href="https://docs.google.com/spreadsheets/d/1vN43E8mFwQe_Mv_6h1v0C_3pX0Y6p7lE8x_v_e6r5C4/copy" target="_blank" class="block text-center bg-green-600 hover:bg-green-500 text-white font-black py-4 rounded-xl shadow-lg transition-all mb-4">CREATE DATABASE COPY</a>
            <div class="text-[10px] text-gray-500 italic p-4 bg-black/20 rounded-lg">Note: You must be logged into your organisational Google account to host the data internally.</div>
          </div>
          <div class="space-y-6">
            <div>
              <label class="block text-slate-400 text-xs font-black uppercase tracking-widest mb-2">Backend Deployment URL</label>
              <input type="text" id="scriptUrl" oninput="saveInput(this)" placeholder="https://script.google.com/macros/s/.../exec" class="input-field">
              <p class="text-[10px] text-gray-500 mt-2">Paste the 'Web App' URL provided after you 'Deploy' the backend script.</p>
            </div>
            <div>
              <label class="block text-slate-400 text-xs font-black uppercase tracking-widest mb-2">Master Admin Key</label>
              <input type="password" id="secretKey" oninput="saveInput(this)" placeholder="Enter a secure password for your monitor dashboard" class="input-field">
            </div>
          </div>
        </div>
      </div>
      <div class="flex justify-between pt-12">
        <button onclick="gotoStep(1)" class="btn bg-slate-800 text-white px-12 font-black uppercase tracking-widest">‚Üê Back</button>
        <button onclick="gotoStep(3)" class="btn btn-primary text-lg px-12 shadow-2xl font-black uppercase tracking-widest">Next: Build Bundle ‚Üí</button>
      </div>
    </div> <div id="step3" class="step-section">
      <div class="highlight-box border-blue-500/30 text-center">
        <h2 class="text-3xl font-black text-white mb-4 uppercase tracking-tighter">Ready to Deploy</h2>
        <p class="text-gray-400 mb-12 max-w-2xl mx-auto">The factory has injected your branding and safety logic into the app bundle. Download the package below and upload it to your host.</p>
        
        <div id="downloadAction" class="bg-blue-600/10 p-12 rounded-3xl border-2 border-dashed border-blue-500/30 mb-8 transition-all">
          <button onclick="buildZip()" class="btn btn-primary text-2xl px-16 shadow-2xl font-black uppercase tracking-widest mb-4 transition-transform hover:scale-105">üöÄ BUILD APP SUITE (.ZIP)</button>
          <p id="buildStatus" class="text-blue-400 font-bold uppercase text-xs tracking-widest"></p>
        </div>

        <div id="launchPack" class="hidden text-left space-y-8 animate-fadeIn">
            <div class="bg-green-600/10 p-8 rounded-2xl border border-green-500/30 flex items-center gap-6 mb-8">
                <div class="bg-green-600 p-4 rounded-xl"><span class="text-4xl">‚úÖ</span></div>
                <div>
                    <h3 class="text-xl font-black text-white uppercase tracking-widest">Build Successful</h3>
                    <p class="text-sm text-gray-400 leading-tight">Your custom safety ecosystem is ready. Follow the guide in the zip folder to go live.</p>
                </div>
            </div>

            <div class="grid md:grid-cols-2 gap-8">
                <div class="bg-slate-800 p-6 rounded-2xl border border-slate-700">
                    <h4 class="text-xs font-black uppercase tracking-widest text-slate-400 mb-4">Worker Install Link (QR)</h4>
                    <div class="bg-white p-4 rounded-xl inline-block mb-4">
                        <img id="qrImage" src="" class="w-48 h-48">
                    </div>
                    <p class="text-[10px] text-slate-500 uppercase font-bold tracking-widest">Point worker phones here once hosted.</p>
                </div>
                <div class="bg-slate-800 p-6 rounded-2xl border border-slate-700">
                    <h4 class="text-xs font-black uppercase tracking-widest text-slate-400 mb-4">Announcement Email Body</h4>
                    <textarea id="launchEmail" readonly class="w-full h-48 bg-slate-900 border border-slate-700 rounded-lg p-4 text-xs text-gray-300 font-mono focus:outline-none"></textarea>
                    <p class="text-[10px] text-slate-500 mt-2 uppercase font-bold tracking-widest">Copy/Paste this into a staff update.</p>
                </div>
            </div>
        </div>
      </div>
    </div> </div> <div class="max-w-6xl mx-auto mt-20 opacity-50 grayscale hover:grayscale-0 transition-all text-center">
    
  </div>

<script>
// 1. NAVIGATION & INITIALIZATION
function gotoStep(step) {
    document.querySelectorAll('.step-section').forEach(s => s.classList.remove('active'));
    document.getElementById('step' + step).classList.add('active');
    document.querySelectorAll('.nav-btn').forEach((b, i) => {
        b.classList.toggle('active', i + 1 === step);
        b.classList.toggle('bg-blue-600', i + 1 === step);
        b.classList.toggle('text-white', i + 1 === step);
    });
    window.scrollTo(0, 0);
}

// 2. INTERACTIVE MOCKUP LOGIC
function updateMockupUI() {
    const org = document.getElementById('orgName').value;
    const logo = document.getElementById('logoUrl').value;
    const primary = localStorage.getItem('otg_theme_primary') || "#1e40af";
    const accent = localStorage.getItem('otg_theme_accent') || "#3b82f6";

    // Update Text & Logo
    document.getElementById('mockOrgName').innerText = org || "My Organisation";
    const mLogo = document.getElementById('mockLogo');
    if(logo && mLogo) {
        mLogo.src = logo;
        mLogo.classList.remove('hidden');
    }

    // Update Themed Components
    const header = document.getElementById('mockHeader');
    const footer = document.getElementById('mockFooter');
    const mainBtn = document.getElementById('mockMainBtn');
    const accentCard = document.getElementById('mockAccentCard');
    const travelCard = document.getElementById('mockTravelCard');

    if(header) header.style.backgroundColor = primary;
    if(footer) footer.style.backgroundColor = primary;
    if(mainBtn) mainBtn.style.backgroundColor = accent;
    
    if(accentCard) {
        accentCard.style.borderColor = accent;
        accentCard.style.backgroundColor = accent + '33'; // 20% opacity
    }
    if(travelCard) {
        travelCard.style.borderColor = accent + '4d'; // 30% opacity
        travelCard.style.backgroundColor = accent + '1a'; // 10% opacity
    }
}

function saveInput(el) { 
    localStorage.setItem('otg_' + el.id, el.type === 'checkbox' ? el.checked : el.value);
    if(['orgName', 'logoUrl', 'primaryColor', 'accentColor'].includes(el.id)) {
        if(el.id === 'primaryColor') document.getElementById('primaryColorBox').style.backgroundColor = el.value;
        if(el.id === 'accentColor') document.getElementById('accentColorBox').style.backgroundColor = el.value;
        updateMockupUI();
    }
}

function applyPreset(p, a, el) {
    document.getElementById('primaryColorBox').style.backgroundColor = p;
    document.getElementById('accentColorBox').style.backgroundColor = a;
    localStorage.setItem('otg_theme_primary', p); 
    localStorage.setItem('otg_theme_accent', a);
    updateMockupUI();
    document.querySelectorAll('.preset-swatch').forEach(s => s.classList.remove('selected'));
    if(el) el.classList.add('selected');
}

// 3. ZIP BUILD ENGINE
async function buildZip() {
    const status = document.getElementById('buildStatus');
    status.innerText = "Compiling resources...";
    
    const zip = new JSZip();
    // Logic for building the ZIP bundle goes here...
    
    status.innerText = "Done! Download started.";
    document.getElementById('launchPack').classList.remove('hidden');
}

// Load saved data on boot
window.onload = () => {
    ['orgName', 'logoUrl', 'scriptUrl', 'secretKey', 'alarmGrace', 'mapsKey'].forEach(id => {
        const val = localStorage.getItem('otg_' + id);
        if(val) document.getElementById(id).value = val;
    });
    const vehicle = localStorage.getItem('otg_vehicleCheck');
    if(vehicle) document.getElementById('vehicleCheck').checked = (vehicle === 'true');
    updateMockupUI();
};
</script>
</body>
</html>
